
common_exes_list = [
  [
    'align-layers',
    [ 'align-layers.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'animation-optimize',
    [ 'animation-optimize.c', ],
    [ gtk3, gegl, gdk_pixbuf, cairo ],
  ],
  # [
  #   'animation-play',
  #   [ 'animation-play.c', ],
  #   [ gtk3, gegl, gdk_pixbuf, ],
  # ],
  [
    'blinds',
    [ 'blinds.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'blur',
    [ 'blur.c', ],
    [ gtk3, gegl, gdk_pixbuf, cairo, ],
  ],
  [
    'border-average',
    [ 'border-average.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'cartoon',
    [ 'cartoon.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'checkerboard',
    [ 'checkerboard.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'cml-explorer',
    [ 'cml-explorer.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'color-cube-analyze',
    [ 'color-cube-analyze.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'colorify',
    [ 'colorify.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'colormap-remap',
    [ 'colormap-remap.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'compose',
    [ 'compose.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'contrast-normalize',
    [ 'contrast-normalize.c', ],
    [ gtk3, gegl, gdk_pixbuf, cairo, ],
  ],
  [
    'contrast-retinex',
    [ 'contrast-retinex.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'crop-zealous',
    [ 'crop-zealous.c', ],
    [ gtk3, gegl, gdk_pixbuf, cairo, ],
  ],
  # [
  #   'curve-bend',
  #   [ 'curve-bend.c', ],
  #   [ gtk3, gegl, gdk_pixbuf, ],
  # ],
  [
    'decompose',
    [ 'decompose.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'depth-merge',
    [ 'depth-merge.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'despeckle',
    [ 'despeckle.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'destripe',
    [ 'destripe.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'edge-dog',
    [ 'edge-dog.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'edge-neon',
    [ 'edge-neon.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'emboss',
    [ 'emboss.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-cel',
    [ 'file-cel.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-compressor',
    [ 'file-compressor.c', ],
    [ gegl, gdk_pixbuf, cairo, gio, liblzma, bz2, zlib, ],
  ],
  [
    'file-csource',
    [ 'file-csource.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-desktop-link',
    [ 'file-desktop-link.c', ],
    [ gtk3, gegl, gdk_pixbuf, cairo, ],
  ],
  [
    'file-dicom',
    [ 'file-dicom.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-gbr',
    [ 'file-gbr.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-gegl',
    [ 'file-gegl.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-gif-load',
    [ 'file-gif-load.c', ],
    [ gtk3, gegl, gdk_pixbuf, cairo, ],
  ],
  [
    'file-gif-save',
    [ 'file-gif-save.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-gih',
    [ 'file-gih.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-glob',
    [ 'file-glob.c', ],
    [ gtk3, gegl, gdk_pixbuf, cairo,  ],
  ],
  [
    'file-header',
    [ 'file-header.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-heif',
    [ 'file-heif.c', ],
    [ gtk3, gegl, libheif, ],
  ],
  [
    'file-html-table',
    [ 'file-html-table.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-jp2-load',
    [ 'file-jp2-load.c', ],
    [ gtk3, gegl, gdk_pixbuf, openjpeg, ],
  ],
  [
    'file-mng',
    [ 'file-mng.c', ],
    [ gtk3, gegl, libmng, libpng, ],
  ],
  [
    'file-pat',
    [ 'file-pat.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-pcx',
    [ 'file-pcx.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-pdf-load',
    [ 'file-pdf-load.c', ],
    [ gtk3, gegl, gdk_pixbuf, poppler ],
  ],
  [
    'file-pdf-save',
    [ 'file-pdf-save.c', ],
    [ gtk3, gegl, gdk_pixbuf, poppler, cairo ],
  ],
  [
    'file-pix',
    [ 'file-pix.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-png',
    [ 'file-png.c', ],
    [ gtk3, gegl, libpng, ],
  ],
  [
    'file-pnm',
    [ 'file-pnm.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-ps',
    [ 'file-ps.c', ],
    [ gtk3, gegl, gdk_pixbuf, ghostscript, ],
  ],
  [
    'file-psp',
    [ 'file-psp.c', ],
    [ gtk3, gegl, zlib, ],
  ],
  [
    'file-raw-data',
    [ 'file-raw-data.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-sunras',
    [ 'file-sunras.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-svg',
    [ 'file-svg.c', ],
    [ gtk3, gegl, rsvg, ],
  ],
  [
    'file-tga',
    [ 'file-tga.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-xbm',
    [ 'file-xbm.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'file-xwd',
    [ 'file-xwd.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'film',
    [ 'film.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'filter-pack',
    [ 'filter-pack.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'fractal-trace',
    [ 'fractal-trace.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'goat-exercise',
    [ 'goat-exercise.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'gradient-map',
    [ 'gradient-map.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'grid',
    [ 'grid.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'guillotine',
    [ 'guillotine.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'hot',
    [ 'hot.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'jigsaw',
    [ 'jigsaw.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'max-rgb',
    [ 'max-rgb.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'newsprint',
    [ 'newsprint.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'nl-filter',
    [ 'nl-filter.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'oilify',
    [ 'oilify.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'photocopy',
    [ 'photocopy.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'plugin-browser',
    [ 'plugin-browser.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'procedure-browser',
    [ 'procedure-browser.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'qbist',
    [ 'qbist.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'sample-colorize',
    [ 'sample-colorize.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'sharpen',
    [ 'sharpen.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'smooth-palette',
    [ 'smooth-palette.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'softglow',
    [ 'softglow.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'sparkle',
    [ 'sparkle.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'sphere-designer',
    [ 'sphere-designer.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'tile-small',
    [ 'tile-small.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'tile',
    [ 'tile.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'unit-editor',
    [ 'unit-editor.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'unsharp-mask',
    [ 'unsharp-mask.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'van-gogh-lic',
    [ 'van-gogh-lic.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'warp',
    [ 'warp.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'wavelet-decompose',
    [ 'wavelet-decompose.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
  [
    'web-browser',
    [ 'web-browser.c', ],
    [ gtk3, gegl, gdk_pixbuf, ],
  ],
]

if platform_win32
  common_exes_list += [
    [
      'mail',
      [ 'mail.c', ],
      [ gtk3, gegl, gdk_pixbuf, ],
    ],
  ]
endif

if wmf.found()
  common_exes_list += [
    [
      'file-wmf',
      [ 'file-wmf.c', ],
      [ gtk3, gegl, wmf, ],
    ],
  ]
endif

if xmc.found()
  common_exes_list += [
    [
      'file-xmc',
      [ 'file-xmc.c', ],
      [ gtk3, gegl, xmc, ],
    ],
  ]
endif

if libxpm.found()
  common_exes_list += [
    [
      'file-xpm',
      [ 'file-xpm.c', ],
      [ gtk3, gegl, libxpm, ],
    ],
  ]
endif

if webkit.found()
  common_exes_list += [
    [
      'web-page',
      [ 'web-page.c', ],
      [ gtk3, gegl, gdk_pixbuf, webkit, ],
    ]
  ]
endif

foreach exe : common_exes_list
  exe_name = exe[0]
  exe_sources = exe[1]
  exe_deps = exe[2]

  plugin_name = exe_name

  rc_file = platform_win32 ? windows.compile_resources(
    gimp_plugins_rc,
    args: [
      '--define', 'ORIGINALFILENAME_STR="@0@"'.format(exe_name+'.exe'),
      '--define', 'INTERNALNAME_STR="@0@"'    .format(exe_name),
      '--define', 'TOP_SRCDIR="@0@"'          .format(meson.source_root()),
    ],
    include_directories: [
      rootInclude, appInclude,
    ],
  ) : []

  executable(exe_name,
    [ exe_sources, rc_file ],
    include_directories: [ rootInclude, ],
    link_with : [
      libgimp,
      libgimpbase,
      libgimpcolor,
      libgimpconfig,
      libgimpmath,
      libgimpui,
      libgimpwidgets,
    ],
    dependencies: [ exe_deps, math ],
    install: true,
    install_dir: join_paths(gimpplugindir, 'plug-ins', plugin_name),
  )
endforeach
